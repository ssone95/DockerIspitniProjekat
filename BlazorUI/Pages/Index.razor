@page "/"



<!-- Home -->

<div class="home">
    <div class="home_slider_container">

        <!-- Home Slider -->
        <div class="owl-carousel owl-theme home_slider">

            <!-- Slider Item -->
            <div class="owl-item home_slider_item">
                <div class="home_slider_background" style="background-image:url(/images/home_slider_1.jpg)"></div>
                <div class="home_slider_content_container">
                    <div class="container">
                        <div class="row">
                            <div class="col">
                                <div class="home_slider_content" data-animation-in="fadeIn" data-animation-out="animate-out fadeOut">
                                    <div class="home_slider_title">A new Online Shop experience.</div>
                                    <div class="home_slider_subtitle">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam a ultricies metus. Sed nec molestie eros. Sed viverra velit venenatis fermentum luctus.</div>
                                    <div class="button button_light home_button"><a href="#">Shop Now</a></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slider Item -->
            @*<div class="owl-item home_slider_item">
                <div class="home_slider_background" style="background-image:url(images/home_slider_1.jpg)"></div>
                <div class="home_slider_content_container">
                    <div class="container">
                        <div class="row">
                            <div class="col">
                                <div class="home_slider_content" data-animation-in="fadeIn" data-animation-out="animate-out fadeOut">
                                    <div class="home_slider_title">A new Online Shop experience.</div>
                                    <div class="home_slider_subtitle">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam a ultricies metus. Sed nec molestie eros. Sed viverra velit venenatis fermentum luctus.</div>
                                    <div class="button button_light home_button"><a href="#">Shop Now</a></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>*@

            <!-- Slider Item -->
            @*<div class="owl-item home_slider_item">
                <div class="home_slider_background" style="background-image:url(images/home_slider_1.jpg)"></div>
                <div class="home_slider_content_container">
                    <div class="container">
                        <div class="row">
                            <div class="col">
                                <div class="home_slider_content" data-animation-in="fadeIn" data-animation-out="animate-out fadeOut">
                                    <div class="home_slider_title">A new Online Shop experience.</div>
                                    <div class="home_slider_subtitle">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam a ultricies metus. Sed nec molestie eros. Sed viverra velit venenatis fermentum luctus.</div>
                                    <div class="button button_light home_button"><a href="#">Shop Now</a></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>*@

        </div>

        <!-- Home Slider Dots -->

        <div class="home_slider_dots_container">
            <div class="container">
                <div class="row">
                    <div class="col">
                        <div class="home_slider_dots">
                            <ul id="home_slider_custom_dots" class="home_slider_custom_dots">
                                <li class="home_slider_custom_dot active"></li>
                                @*<li class="home_slider_custom_dot">02.</li>
                                <li class="home_slider_custom_dot">03.</li>*@
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>

<div class="avds">
    <div class="avds_container d-flex flex-lg-row flex-column align-items-start justify-content-between">
        <div class="avds_small">
            <div class="avds_background" style="background-image:url(images/avds_small.jpg)"></div>
            <div class="avds_small_inner">
                <div class="avds_discount_container">
                    <img src="images/discount.png" alt="">
                    <div>
                        <div class="avds_discount">
                            <div>20<span>%</span></div>
                            <div>Discount</div>
                        </div>
                    </div>
                </div>
                <div class="avds_small_content">
                    <div class="avds_title">Smart Phones</div>
                    <div class="avds_link"><a href="categories.html">See More</a></div>
                </div>
            </div>
        </div>
        <div class="avds_large">
            <div class="avds_background" style="background-image:url(images/avds_large.jpg)"></div>
            <div class="avds_large_container">
                <div class="avds_large_content">
                    <div class="avds_title">Professional Cameras</div>
                    <div class="avds_text">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam a ultricies metus. Sed nec molestie eros. Sed viver ra velit venenatis fermentum luctus.</div>
                    <div class="avds_link avds_link_large"><a href="categories.html">See More</a></div>
                </div>
            </div>
        </div>
    </div>
</div>

@using BlazorUI.Data
@inject BlazorUI.Helpers.ApiHelper api
@inject WeatherForecastService ForecastService;


<div class="products">
    <div class="container">
        <div class="row">
            <div class="col">

                <div class="product_grid">


                    @foreach (var product in products)
                    {
                        <div class="product">
                            <div class="product_image"><img src="images/product_1.jpg" alt=""></div>
                            <div class="product_extra product_new"><a href="categories.html">New</a></div>
                            <div class="product_content">
                                <div class="product_title"><a href="/Product/@product.Id">@product.Name</a></div>
                                <div class="product_price">@product.CalculatedPrice</div>
                            </div>
                        </div>
                    }


                </div>

            </div>
        </div>
    </div>
</div>


@code {
    private List<Domain.Products.Product> products = new List<Domain.Products.Product>();

    private int currentPage { get; set; } = 1;


    private int itemsPerPage { get; set; } = 6;


    protected override async Task OnInitializedAsync()
    {
        if (products.Count() < 1)
            await GetProducts();
    }

    async Task GetProducts()
    {
        var response = await api.Post<List<Domain.Products.Product>>("api/Product/List", new Domain.DTO.ProductFilterDTO()
        {
            CurrentPage = currentPage,
            ItemsPerPage = itemsPerPage
        });

        var data = response?.Result ?? new List<Domain.Products.Product>();

        //List<Domain.Products.Product> data = new List<Domain.Products.Product>()
        //{
        //    new Domain.Products.Product() { Id = 1, Name = "ASD", Discount = 1 },
        //    new Domain.Products.Product() { Id = 2, Name = "DSA", Discount = 1 },
        //    new Domain.Products.Product() { Id = 3, Name = "SDF", Discount = 1 },
        //};
        products.AddRange(data);
    }

    async Task ItemsPerPageUpdated(ChangeEventArgs e)
    {
        int pageItems = 1;
        currentPage = 1;
        string pageItemsStr = e.Value as string;
        Int32.TryParse(pageItemsStr ?? "1", out pageItems);
        products.Clear();
        itemsPerPage = pageItems;
        await GetProducts();
    }

    async Task LoadMore()
    {
        currentPage++;
        await GetProducts();
    }
}
